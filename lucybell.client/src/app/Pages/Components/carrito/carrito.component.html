<div *ngIf="cartOpen" class="fixed inset-0 bg-black bg-opacity-50 z-40" (click)="cerrarCarrito()"></div>

<div [ngClass]="{'translate-x-full': !cartOpen, 'translate-x-0': cartOpen}" class="fixed right-0 top-0 w-96 h-full bg-MyBg shadow-lg z-100 transition-transform duration-300 transform overflow-y-auto">
    
  <div class="p-4 flex justify-between items-center">
    <h2 class="text-xl font-bold">Carrito de Compras</h2>
    <button (click)="cerrarCarrito()" class="text-gray-500 text-4xl">&times;</button>
  </div>

  <div *ngIf="mensajeError" class="alert alert-danger text-base " [ngClass]="{'escondida': mensajeError === null}">
    {{ mensajeError }}
  </div>

  <div class="absolute w-full h-px bg-gradient-to-r from-transparent via-black z-100 box-border"></div>
  <div class="p-2 flex justify-between items-center text-xs font-bold border-b border-gray-300">
    <p>Productos</p>
    <p>Subtotal</p>
  </div>
  <div class="absolute w-full h-px bg-gradient-to-r from-transparent via-black z-100 box-border"></div>

  
  <div *ngFor="let item of listCarrito; let i = index" class="flex items-center p-4 border-b border-gray-300">
    <img [src]="item.producto.imagenesProductos[0].urlImagen" alt="Imagen del producto" class="w-16 h-16 object-cover rounded-lg mr-4" />

    <div class="flex-1">
      <h4 class="text-base font-bold">
        {{ item.producto.nombre }} 
        <span *ngIf="item.varianteSeleccionada"> - {{ item.varianteSeleccionada.color }}</span>
      </h4>
      <div class="inline-flex items-center border border-gray-300 rounded-lg p-1 bg-white mt-2">
        <button (click)="disminuirCantidad(i)" class="bg-gray-200 p-1 rounded-full mr-2">
          <img src="../../../assets/icons/Minus.svg" alt="Disminuir" class="w-4 h-4" />
        </button>
        <span class="font-bold">{{ item.cantidad }}</span>
        <button (click)="aumentarCantidad(i)" class="bg-gray-200 p-1 rounded-full ml-2">
          <img src="../../../assets/icons/Plus.svg" alt="Aumentar" class="w-4 h-4" />
        </button>
      </div>
    </div>

    <div class="flex flex-col items-end ml-4">
      <p class="font-bold text-xs">${{ (item.producto.precio * item.cantidad) | number: '1.2-2' }}</p>
      <button (click)="eliminarItem(i)" class="text-red-500 hover:scale-125 transition duration-150 ease-in-out mt-2">
        <img src="../../../assets/icons/RedDelete.svg" alt="Eliminar" class="w-5 h-5"/>
      </button>
    </div>
  </div>

  <div *ngIf="listCarrito.length === 0" class="p-4 text-center">
    <p>El carrito está vacío.</p>
  </div>

  <div class="p-4 bg-white">
    <h5 class="text-lg font-bold">RESUMEN COMPRA</h5>
    <hr class="my-2"/>
    <div class="flex justify-between mb-4">
      <p class="mb-2">Total</p>
      <p class="mb-2">${{ carritoService.total() | number: '1.2-2' }}</p>
    </div>
    <button (click)="navegarAlResumen()" [disabled]="listCarrito.length == 0" type="button" class="bg-black text-white w-full py-2 font-bold">
      PROCESAR
    </button>
  </div>
</div>
